# 1.需求分析

## 1.1 用户需求分析

当下河海大学校园防疫措施收紧，河海学子想出校门必须提前一天申请，许多同学觉得多有不便，而部分门卫检查出门码严格，无法拿着之前的截图蒙混过关，因此我们设计出了这款小程序，帮助大家便捷出行。

### 2.2 交互界面

首先index首页要有一个按钮提示用户自己在相册中选择图片作为背景。用户选择好自己处理好的图片之后上传，该图片会作为背景显示，与时间一起组成模拟界面。

为方便用户使用，小程序商法有设计一个隐藏式按钮，不易被发现，点击后可以进入相机页面，模拟扫码的功能，用户手动返回，可以返回到结果页面。

### 2.3 软件保密

提供时间戳合成工具，用户自己提供图片，合成带有时间的图片。

# 2.概要设计

## 2.1模块层次结构

![image-20220208173331969](C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208173331969.png)





小程序分为两个主要页面——index与photo，index为显示的主界面,photo为摄像机界面，它们以index中的index.wxml文件里的button作为桥梁链接。这两个主要页面都定义在pages这个文件夹内，与pages平行的是一个utils文件夹，其中有个util.js文件，里面定义了微信小程序自带的公用的方法，而我们要在index.js中用到其中的formatTime函数来获取当前时间。

## 2.2业务流程

首先index首页要有一个按钮提示用户自己在相册中选择图片作为背景。用户选择好自己处理好的图片之后上传，该图片会作为背景显示，与时间一起组成模拟界面。

为方便用户使用，小程序商法有设计一个隐藏式按钮，不易被发现，点击后可以进入相机页面，模拟扫码的功能。



![image-20220208180850223](C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208180850223.png)

具体流程：



![image-20220208182109750](C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208182109750.png)

![image-20220208182145310](C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208182145310.png)

<img src="C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208182223094.png" alt="image-20220208182223094" style="zoom: 50%;" />



![image-20220208183345028](C:\Users\10203\AppData\Roaming\Typora\typora-user-images\image-20220208183345028.png)



## 2.3模块描述

### 2.3.1 Index

进入小程序，首先用户需要从相册选择图片，作为自己的背景，小程序提供时间戳合成工具，模拟出的出门码页面，基于formatTime显示当前时间。

点击屏幕上方的空白处，可以打开photo页面，该页面为一个摄像头，点击左上方返回出门码页面。

### 2.3.2 photo

该页面为点击按钮后跳转到的页面。为一个覆盖小程序界面的摄像机。

## 2.4技术难点

### 2.4.1 获取当前时间

小程序界面有一段文字，显示当前时间，要做出模拟码，也必须在主页显示当前时间，这里主要运用util.js中小程序库自带的fromatTime函数，仅对输出格式进行简单修改使其符合要求。

### 2.4.2 时间戳合成

首先做一个按钮，提示用户要自己在相册中选择图片，再使用微信自带的图片全屏预览功能：wx.previewImage模拟出合成的界面，通过时间戳合成工具添加当前的时间。

### 2.4.3 隐藏式按钮跳转相机页面

因为出示出门码之前需要有一个扫码的举动，为方便用户使用，要实现在主页做一个隐藏按钮，点击之后会跳转到相机页面。

# 3.详细设计

## 3.1 出示界面

### 3.1.1 背景图片

背景图片由用户自己在手机相册中选择。

### 3.1.2 显示当前时间

对于显示时间的部分，首先在index页面的js中导入util.js,在其中调用formatTime函数来获得当前时，然后再在index的wxml页面中插入一段文字，文字内容是{{time}}即可显示时间。

## 3.2 隐藏式按钮跳转相机界面

### 3.2.1 透明按钮

对于跳转相机页面的部分，这里是设计按钮的样式，做一个透明按钮，达到“隐藏”效果

### 3.2.2 跳转事件

设置透明按钮属性bindtap，指出点击它触发的事件,在index的js文件中，写出对应的函数，设置点击按钮触发的事件。这里的事件是利用navigateTo函数实现的页面跳转，点击按钮后跳转到的页面是摄像机页面。